{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flamarkt/backoffice/webpack/bootstrap","webpack://@flamarkt/backoffice/webpack/runtime/compat get default export","webpack://@flamarkt/backoffice/webpack/runtime/define property getters","webpack://@flamarkt/backoffice/webpack/runtime/hasOwnProperty shorthand","webpack://@flamarkt/backoffice/webpack/runtime/make namespace object","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['forum/app']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['forum/components/SessionDropdown']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flamarkt/backoffice/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/backoffice/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/Component']\"","webpack://@flamarkt/backoffice/./src/common/utils/KeyboardNavigatable.ts","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@flamarkt/backoffice/./src/common/components/AbstractRelationshipSelect.ts","webpack://@flamarkt/backoffice/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/app']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/components/Dropdown']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/components/Button']\"","webpack://@flamarkt/backoffice/./src/common/components/AbstractSortDropdown.ts","webpack://@flamarkt/backoffice/./src/common/components/ActiveLinkButton.ts","webpack://@flamarkt/backoffice/./src/common/components/Sortable.ts","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@flamarkt/backoffice/./src/common/components/SortableHandle.ts","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@flamarkt/backoffice/./src/common/components/UserRelationshipSelect.ts","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/components/Page']\"","webpack://@flamarkt/backoffice/external root \"flarum.core.compat['common/Model']\"","webpack://@flamarkt/backoffice/./src/common/pages/AbstractShowPage.ts","webpack://@flamarkt/backoffice/./src/common/states/AbstractListState.ts","webpack://@flamarkt/backoffice/./src/common/compat.js","webpack://@flamarkt/backoffice/./src/forum/index.ts","webpack://@flamarkt/backoffice/./src/common/registerPatchInitializer.ts","webpack://@flamarkt/backoffice/./src/common/patchModelHasOneNull.ts","webpack://@flamarkt/backoffice/./src/common/patchStoreAllowVerbatimRelationships.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SessionDropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","type KeyboardEventHandler = (event: KeyboardEvent) => void;\ntype ShouldHandle = (event: KeyboardEvent) => boolean;\n\nenum Keys {\n    Enter = 13,\n    Escape = 27,\n    Space = 32,\n    ArrowUp = 38,\n    ArrowDown = 40,\n    ArrowLeft = 37,\n    ArrowRight = 39,\n    Tab = 9,\n    Backspace = 8,\n}\n\n/**\n * Same as Flarum's, but in common namespace so we can use it in backoffice as wel\n */\nexport default class KeyboardNavigatable {\n    /**\n     * Callback to be executed for a specified input.\n     */\n    protected callbacks = new Map<number, KeyboardEventHandler>();\n\n    /**\n     * Callback that determines whether keyboard input should be handled.\n     * By default, always handle keyboard navigation.\n     */\n    protected whenCallback: ShouldHandle = (event: KeyboardEvent) => true;\n\n    /**\n     * Provide a callback to be executed when navigating upwards.\n     *\n     * This will be triggered by the Up key.\n     */\n    onUp(callback: KeyboardEventHandler): KeyboardNavigatable {\n        this.callbacks.set(Keys.ArrowUp, (e) => {\n            e.preventDefault();\n            callback(e);\n        });\n\n        return this;\n    }\n\n    /**\n     * Provide a callback to be executed when navigating downwards.\n     *\n     * This will be triggered by the Down key.\n     */\n    onDown(callback: KeyboardEventHandler): KeyboardNavigatable {\n        this.callbacks.set(Keys.ArrowDown, (e) => {\n            e.preventDefault();\n            callback(e);\n        });\n\n        return this;\n    }\n\n    /**\n     * Provide a callback to be executed when the current item is selected..\n     *\n     * This will be triggered by the Return key (and Tab key, if not disabled).\n     */\n    onSelect(callback: KeyboardEventHandler, ignoreTabPress: boolean = false): KeyboardNavigatable {\n        const handler: KeyboardEventHandler = (e) => {\n            e.preventDefault();\n            callback(e);\n        };\n\n        if (!ignoreTabPress) this.callbacks.set(Keys.Tab, handler);\n        this.callbacks.set(Keys.Enter, handler);\n\n        return this;\n    }\n\n    /**\n     * Provide a callback to be executed when the current item is tabbed into.\n     *\n     * This will be triggered by the Tab key.\n     */\n    onTab(callback: KeyboardEventHandler): KeyboardNavigatable {\n        const handler: KeyboardEventHandler = (e) => {\n            e.preventDefault();\n            callback(e);\n        };\n\n        this.callbacks.set(9, handler);\n\n        return this;\n    }\n\n    /**\n     * Provide a callback to be executed when the navigation is canceled.\n     *\n     * This will be triggered by the Escape key.\n     */\n    onCancel(callback: KeyboardEventHandler): KeyboardNavigatable {\n        this.callbacks.set(Keys.Escape, (e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            callback(e);\n        });\n\n        return this;\n    }\n\n    /**\n     * Provide a callback to be executed when previous input is removed.\n     *\n     * This will be triggered by the Backspace key.\n     */\n    onRemove(callback: KeyboardEventHandler): KeyboardNavigatable {\n        this.callbacks.set(Keys.Backspace, (e) => {\n            if (e instanceof KeyboardEvent && e.target instanceof HTMLInputElement && e.target.selectionStart === 0 && e.target.selectionEnd === 0) {\n                callback(e);\n                e.preventDefault();\n            }\n        });\n\n        return this;\n    }\n\n    /**\n     * Provide a callback that determines whether keyboard input should be handled.\n     */\n    when(callback: ShouldHandle): KeyboardNavigatable {\n        this.whenCallback = callback;\n\n        return this;\n    }\n\n    /**\n     * Set up the navigation key bindings on the given jQuery element.\n     */\n    bindTo($element: JQuery<HTMLElement>) {\n        // Handle navigation key events on the navigatable element.\n        $element[0].addEventListener('keydown', this.navigate.bind(this));\n    }\n\n    /**\n     * Interpret the given keyboard event as navigation commands.\n     */\n    navigate(event: KeyboardEvent) {\n        // This callback determines whether keyboard should be handled or ignored.\n        if (!this.whenCallback(event)) return;\n\n        const keyCallback = this.callbacks.get(event.which);\n        if (keyCallback) {\n            keyCallback(event);\n        }\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","import {Children, Vnode, VnodeDOM} from 'mithril';\nimport Component, {ComponentAttrs} from 'flarum/common/Component';\nimport Model from 'flarum/common/Model';\nimport KeyboardNavigatable from '../utils/KeyboardNavigatable';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport classList from 'flarum/common/utils/classList';\nimport ItemList from 'flarum/common/utils/ItemList';\n\nexport interface RelationshipSelectAttrs<T> extends ComponentAttrs {\n    relationship: T | T[] | null\n    hasOne?: boolean\n    onchange?: (value: T | T[] | null) => {},\n    placeholder?: string\n    suggest?: T | T[] | (() => Promise<T | T[]>)\n    disabled?: boolean\n    readonly?: boolean\n}\n\nexport default abstract class AbstractRelationshipSelect<T extends Model> extends Component<RelationshipSelectAttrs<T>> {\n    searchFilter: string = '';\n    debouncedSearchFilter: string = '';\n    searchDebouncer?: number;\n    activeListIndex: number = 0;\n    inputIsFocused: boolean = false;\n    navigator!: KeyboardNavigatable;\n    dropdownIsFocused: boolean = false\n    onmousedown!: (event: Event) => void\n    cachedSuggestedResults: T[] | null = null\n    suggestedPromiseLoaded: boolean = false\n\n    className(): string {\n        return '';\n    }\n\n    abstract search(query: string): Promise<void>\n\n    abstract results(query: string): T[] | null\n\n    abstract item(model: T, query?: string): Children\n\n    normalizedValue(): T[] {\n        if (Array.isArray(this.attrs.relationship)) {\n            return this.attrs.relationship;\n        }\n\n        if (this.attrs.relationship) {\n            return [this.attrs.relationship];\n        }\n\n        return [];\n    }\n\n    setValue(models: T[]) {\n        if (!this.attrs.onchange) {\n            return;\n        }\n\n        if (this.attrs.hasOne) {\n            this.attrs.onchange(models.length ? models[0] : null);\n        } else {\n            this.attrs.onchange(models);\n        }\n    }\n\n    oninit(vnode: Vnode<RelationshipSelectAttrs<T>, this>) {\n        super.oninit(vnode);\n\n        this.navigator = new KeyboardNavigatable();\n        this.navigator\n            .onUp(() => this.setIndex(this.activeListIndex - 1, true))\n            .onDown(() => this.setIndex(this.activeListIndex + 1, true))\n            .onSelect(this.select.bind(this))\n            .onRemove(() => {\n                const models = this.normalizedValue();\n\n                if (!models.length) {\n                    return;\n                }\n\n                this.toggleModel(models[models.length - 1]);\n            })\n            .when(event => {\n                // We want to allow selecting with space because it's a common way to select\n                // However this interferes with the ability to enter spaces\n                // So we will have space act as select, but only if nothing is typed yet\n                if (event.key === ' ' && this.searchFilter === '') {\n                    event.preventDefault();\n                    this.select(event);\n\n                    return false;\n                }\n\n                // We don't want Tab to act as select, as this prevent moving from field to field\n                return event.key !== 'Tab';\n            });\n    }\n\n    oncreate(vnode: VnodeDOM<RelationshipSelectAttrs<T>, this>) {\n        super.oncreate(vnode);\n\n        // Since we are not calling the original Component.oncreate, we need to copy the dom reference manually\n        this.element = vnode.dom;\n\n        this.onmousedown = (event: Event) => {\n            const dropdown = vnode.dom.querySelector('.Dropdown-menu');\n\n            if (\n                dropdown &&\n                dropdown.contains(event.target as HTMLElement)\n            ) {\n                if (!this.dropdownIsFocused) {\n                    this.dropdownIsFocused = true;\n                    m.redraw();\n                }\n            } else {\n                if (this.dropdownIsFocused) {\n                    this.dropdownIsFocused = false;\n                    m.redraw();\n                }\n            }\n        };\n\n        document.addEventListener('mousedown', this.onmousedown);\n    }\n\n    onremove(vnode: VnodeDOM<RelationshipSelectAttrs<T>, this>) {\n        super.onremove(vnode);\n\n        document.removeEventListener('mousedown', this.onmousedown);\n    }\n\n    indexInSelectedModels(model: T) {\n        return this.normalizedValue().findIndex(m => m.id() === model.id());\n    }\n\n    addModel(model: T) {\n        if (this.attrs.hasOne) {\n            this.setValue([model]);\n        } else {\n            const models = this.normalizedValue();\n\n            models.push(model);\n\n            this.setValue(models);\n        }\n    }\n\n    removeModel(model: T) {\n        const index = this.indexInSelectedModels(model);\n\n        if (index !== -1) {\n            const models = this.normalizedValue();\n\n            models.splice(index, 1);\n\n            this.setValue(models);\n        }\n    }\n\n    view() {\n        const results = this.results(this.debouncedSearchFilter);\n\n        const directionUp = this.directionUp();\n\n        if (directionUp) {\n            results?.reverse();\n        }\n\n        return m('.RelationshipSelect', {\n            className: classList(this.className(), {\n                focused: this.inputIsFocused,\n                disabled: this.attrs.disabled,\n                readonly: this.attrs.readonly,\n                'direction-up': directionUp,\n            }),\n        }, [\n            m('.RelationshipSelect-Form', this.formItems().toArray()),\n            this.listAvailableModels(results),\n        ]);\n    }\n\n    formItems() {\n        const items = new ItemList();\n\n        items.add('input', m('.RelationshipSelect-FakeInput-Wrapper', m('.RelationshipSelect-FakeInput.FormControl', {\n            className: classList({\n                focus: this.inputIsFocused, // deprecated. Check for .focused on .RelationshipSelect\n            }),\n        }, this.inputItems().toArray())), 20);\n\n        return items;\n    }\n\n    inputItems() {\n        const items = new ItemList();\n\n        items.add('selected', this.normalizedValue().map(model => {\n            return m('span.RelationshipSelect-Selected', {\n                onclick: () => {\n                    if (this.attrs.disabled || this.attrs.readonly) {\n                        return;\n                    }\n\n                    this.toggleModel(model);\n                    this.onready();\n                },\n            }, this.item(model));\n        }), 20);\n\n        items.add('control', m('input.FormControl', {\n            placeholder: this.attrs.placeholder,\n            value: this.searchFilter,\n            oninput: (event: Event) => {\n                this.searchFilter = (event.target as HTMLInputElement).value;\n                this.activeListIndex = 0;\n\n                clearTimeout(this.searchDebouncer);\n\n                this.searchDebouncer = setTimeout(() => {\n                    this.debouncedSearchFilter = this.searchFilter;\n                    this.search(this.debouncedSearchFilter);\n                }, 300) as any;\n            },\n            onkeydown: this.navigator.navigate.bind(this.navigator),\n            // Use local methods so that other extensions can extend behaviour\n            onfocus: this.oninputfocus.bind(this),\n            onblur: this.oninputblur.bind(this),\n            disabled: this.attrs.disabled,\n            readonly: this.attrs.readonly,\n        }), 10);\n\n        return items;\n    }\n\n    oninputfocus() {\n        this.inputIsFocused = true;\n\n        // If we click or move to the input without typing anything, we want to autocomplete the empty query\n        if (this.debouncedSearchFilter === '') {\n            this.search(this.debouncedSearchFilter);\n        }\n    }\n\n    oninputblur() {\n        this.inputIsFocused = false;\n    }\n\n    listAvailableModels(models: T[] | null): Children {\n        // We need two attributes to hold the dropdown open\n        // One is the input focus, managed by the modal\n        // The second one is needed because there's a short moment during a click where the focus is lost on the input\n        // mousedown triggers first, then the input blur, and only in mouseup can we put focus on the input again\n        if (!(this.inputIsFocused || this.dropdownIsFocused) || (Array.isArray(models) && models.length === 0)) {\n            return null;\n        }\n\n        let content;\n\n        if (models === null) {\n            content = LoadingIndicator.component();\n        } else {\n            content = models.map(this.listAvailableModel.bind(this));\n        }\n\n        return m('ul.Dropdown-menu.RelationshipSelect-Dropdown', content);\n    }\n\n    listAvailableModel(model: T, index: number) {\n        // Using a wrapper around the item to cancel Flarum default li > span rules\n        // And this could be useful for customization\n        return m('li.RelationshipSelect-Dropdown-Item', {\n            'data-index': index,\n            className: classList({\n                selected: this.indexInSelectedModels(model) !== -1,\n                active: this.activeListIndex === index,\n            }),\n            onmouseover: () => this.activeListIndex = index,\n            onclick: this.toggleModel.bind(this, model),\n        }, m('.RelationshipSelect-Dropdown-Item-Wrap', this.item(model, this.debouncedSearchFilter)));\n    }\n\n    toggleModel(model: T) {\n        const index = this.indexInSelectedModels(model);\n\n        if (index !== -1) {\n            this.removeModel(model);\n        } else {\n            this.addModel(model);\n        }\n\n        if (this.searchFilter) {\n            this.searchFilter = '';\n            this.debouncedSearchFilter = '';\n            this.activeListIndex = 0;\n        }\n\n        // Defer re-focusing to next browser draw\n        setTimeout(() => {\n            this.onready();\n        });\n    }\n\n    select(e: KeyboardEvent) {\n        const $element = this.getDomElement(this.activeListIndex);\n\n        // If nothing matches, the user probably typed text that doesn't match anything\n        // In that case we don't want to submit just yet, but we will delete the text\n        // so that typing enter multiple times does end up submitting\n        if (!$element.length) {\n            this.searchFilter = '';\n            this.debouncedSearchFilter = '';\n            return;\n        }\n\n        $element[0].dispatchEvent(new Event('click'));\n    }\n\n    getDomElement(index: number) {\n        return this.$(`.RelationshipSelect-Dropdown-Item[data-index=\"${index}\"]`);\n    }\n\n    setIndex(index: number, scrollToItem: boolean) {\n        const $dropdown = this.$('.RelationshipSelect-Dropdown');\n\n        const indexLength = this.$('.RelationshipSelect-Dropdown-Item').length;\n\n        if (index < 0) {\n            index = indexLength - 1;\n        } else if (index >= indexLength) {\n            index = 0;\n        }\n\n        const $item = this.getDomElement(index);\n        this.activeListIndex = index;\n\n        m.redraw();\n\n        if (scrollToItem) {\n            const dropdownScroll = $dropdown.scrollTop() || 0;\n            const dropdownTop = $dropdown.offset()?.top || 0;\n            const dropdownBottom = dropdownTop + ($dropdown.outerHeight() || 0);\n            const itemTop = $item.offset()?.top || 0;\n            const itemBottom = itemTop + ($item.outerHeight() || 0);\n\n            let scrollTop;\n            if (itemTop < dropdownTop) {\n                scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n            } else if (itemBottom > dropdownBottom) {\n                scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n            }\n\n            if (typeof scrollTop !== 'undefined') {\n                $dropdown.stop(true).animate({scrollTop}, 100);\n            }\n        }\n    }\n\n    onready() {\n        this.$('input').first().focus().select();\n    }\n\n    /**\n     * Whether the dropdown should open above the field instead of below\n     */\n    directionUp(): boolean {\n        if (!(this.element instanceof HTMLElement)) {\n            return false;\n        }\n\n        const bounding = this.element.getBoundingClientRect();\n\n        const spaceAvailableBelow = window.innerHeight - bounding.bottom;\n\n        return spaceAvailableBelow < 200;\n    }\n\n    /**\n     * Shortcut to be used in the results() implementation to render the suggestions.\n     * If the suggestion is a function, its resulting Promise will be executed and the Select will redraw once results are available.\n     * If there are zero suggestions, null will be returned to show the spinner identically to a Select without suggestions.\n     */\n    suggestedResults(): T[] | null {\n        if (!this.attrs.suggest) {\n            return null;\n        }\n\n        if (typeof this.attrs.suggest === 'function') {\n            if (!this.suggestedPromiseLoaded) {\n                this.suggestedPromiseLoaded = true;\n\n                this.attrs.suggest().then(results => {\n                    if (Array.isArray(results)) {\n                        if (results.length) {\n                            this.cachedSuggestedResults = results;\n                        }\n                    } else if (results) {\n                        this.cachedSuggestedResults = [results];\n                    }\n\n                    m.redraw();\n                });\n            }\n\n            return this.cachedSuggestedResults;\n        }\n\n        if (!Array.isArray(this.attrs.suggest)) {\n            // No need to check for falsy, it was already done at the beginning\n            return [this.attrs.suggest];\n        }\n\n        if (this.attrs.suggest.length) {\n            return this.attrs.suggest;\n        }\n\n        return null;\n    }\n}\n","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Dropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import app from 'flarum/common/app';\nimport Component, {ComponentAttrs} from 'flarum/common/Component';\nimport Dropdown from 'flarum/common/components/Dropdown';\nimport Button from 'flarum/common/components/Button';\nimport Model from 'flarum/common/Model';\nimport AbstractListState from '../states/AbstractListState';\n\nexport interface SortDropdownAttrs extends ComponentAttrs {\n    /**\n     * @deprecated use `list` instead\n     */\n    state: AbstractListState<Model>\n    list: AbstractListState<Model>\n    updateUrl?: boolean\n}\n\nexport interface SortOptions {\n    [key: string]: string\n}\n\nexport default abstract class AbstractSortDropdown<T extends SortDropdownAttrs> extends Component<T> {\n    protected static initAttrs<T extends SortDropdownAttrs>(attrs: T) {\n        if (attrs.state) {\n            console.warn('SortDropdownAttrs.state is deprecated, use .list');\n            attrs.list = attrs.state;\n        }\n    }\n\n    view() {\n        const options = this.options();\n\n        const activeSort = this.activeSort();\n\n        return m(Dropdown, {\n            className: 'SortDropdown ' + this.className(),\n            buttonClassName: 'Button',\n            label: options[activeSort],\n            icon: 'fas fa-sort-amount-' + (this.sortIsUp(activeSort) ? 'up' : 'down'),\n        }, Object.keys(options).map((value) => {\n            const label = options[value];\n            const active = value === this.activeSort();\n\n            return m(Button, {\n                icon: active ? 'fas fa-check' : true,\n                onclick: () => {\n                    this.applySort(value);\n                },\n                active,\n            }, label);\n        }));\n    }\n\n    className(): string {\n        return '';\n    }\n\n    activeSort(): string {\n        return this.attrs.list.params.sort || this.defaultSort();\n    }\n\n    sortIsUp(sort: string) {\n        return sort.substr(0, 1) !== '-';\n    }\n\n    applySort(sort: string) {\n        // Clone params otherwise it causes a page refresh even without m.route.set\n        const params = {...m.route.param()};\n\n        if (this.defaultSort() === sort) {\n            delete this.attrs.list.params.sort;\n            delete params.sort;\n        } else {\n            this.attrs.list.params.sort = sort;\n            params.sort = sort;\n        }\n\n        if (this.attrs.updateUrl) {\n            delete params.key;\n\n            // @ts-ignore\n            const {routeName} = app.current.data;\n\n            m.route.set(app.route(routeName, params));\n        } else {\n            this.attrs.list.refresh();\n        }\n    }\n\n    abstract options(): SortOptions\n\n    defaultSort(): string {\n        return Object.keys(this.options())[0];\n    }\n}\n\n","import app from 'flarum/common/app';\nimport {ComponentAttrs} from 'flarum/common/Component';\nimport LinkButton from 'flarum/common/components/LinkButton';\n\nexport interface ActiveLinkButtonAttrs extends ComponentAttrs {\n    href: string\n    activeRoutes?: string[]\n}\n\n/**\n * A modified LinkButton that accepts a new activeRoutes attr that defines on which routes\n * the button should be rendered as active.\n * The attribute is an array of strings. The strings can optionally be terminated with *\n * to match all routes with the prefix.\n */\n// @ts-ignore view method not type-hinted\nexport default class ActiveLinkButton extends LinkButton {\n    static isActive(attrs: ActiveLinkButtonAttrs) {\n        return m.route.get() === attrs.href || ActiveLinkButton.activeRoutes(attrs).some(routeName => {\n            const currentRouteName = (app.current.data as any).routeName;\n\n            // In the admin panel, this is called before a first page sets routeName apparently\n            if (!currentRouteName) {\n                return false;\n            }\n\n            const matchAllIndex = routeName.indexOf('*');\n\n            if (matchAllIndex !== -1) {\n                // We always assume that * is at the end, and use everything up to that point as the string\n                return currentRouteName.indexOf(routeName.substr(0, matchAllIndex)) === 0;\n            }\n\n            return currentRouteName === routeName;\n        });\n    }\n\n    static activeRoutes(attrs: ActiveLinkButtonAttrs): string[] {\n        if (attrs.activeRoutes) {\n            return attrs.activeRoutes;\n        }\n\n        return [];\n    }\n}\n","import {ClassComponent, Vnode, VnodeDOM} from 'mithril';\n\nexport interface SortableAttrs {\n    className?: string\n    handleClassName?: string | null\n    containerTag?: string\n    placeholderTag?: string\n    disabled?: boolean\n    direction?: 'vertical' | 'horizontal'\n    onsort: (origin: number, destination: number) => void,\n}\n\n/**\n * A sortable implementation inspired by html5sortable, but designed to work with Mithril\n * The sortable children must be a flat array of vnodes and be keyed\n */\nexport default class Sortable implements ClassComponent<SortableAttrs> {\n    sortingIndex: number | null = null;\n    showPlaceholderForIndex: number = 0;\n\n    dragoverenterhandler!: (event: DragEvent) => void;\n    drophandler!: (event: DragEvent) => void;\n\n    oncreate(vnode: VnodeDOM<SortableAttrs>) {\n        // We need to handle both dragover and dragenter to prevent inputs from showing a cursor when hovered\n        // We also need this event to handle mouse movement because stopping propagation seems to stop mousemove event\n        this.dragoverenterhandler = event => {\n            if (this.sortingIndex !== null) {\n                event.preventDefault();\n                event.stopPropagation();\n                // @ts-ignore dataTransfer could be null... but not sure when that could happen\n                event.dataTransfer.dropEffect = 'move';\n\n                let targetIndex = 0;\n\n                // We will show the placeholder above or below the hovered item using the middle height as criteria\n                (vnode.dom.childNodes as any as HTMLElement[]).forEach(element => {\n                    const index = parseInt(element.dataset.index || '');\n\n                    // Ignore elements without an index (those will be the placeholders)\n                    if (isNaN(index)) {\n                        return;\n                    }\n\n                    const position = element.getBoundingClientRect();\n\n                    if (vnode.attrs.direction === 'horizontal') {\n                        // Ignore invisible elements\n                        if (!position.width) {\n                            return;\n                        }\n\n                        const middleX = position.left + (position.width / 2);\n\n                        if (event.pageX > middleX + window.scrollX) {\n                            targetIndex = index + 1;\n                        }\n                    } else {\n                        // Ignore invisible elements\n                        if (!position.height) {\n                            return;\n                        }\n\n                        const middleY = position.top + (position.height / 2);\n\n                        if (event.pageY > middleY + window.scrollY) {\n                            targetIndex = index + 1;\n                        }\n                    }\n                });\n\n                if (targetIndex !== this.showPlaceholderForIndex) {\n                    this.showPlaceholderForIndex = targetIndex;\n                    m.redraw();\n                }\n            }\n        };\n\n        document.addEventListener('dragover', this.dragoverenterhandler);\n        document.addEventListener('dragenter', this.dragoverenterhandler);\n\n        // Prevent dropping our sortable item into anything else\n        // Without this it's possible to drop the value into inputs or worse, cause the browser to navigate to 0.0.0.0\n        this.drophandler = event => {\n            if (this.sortingIndex !== null) {\n                event.preventDefault();\n                event.stopPropagation();\n\n                const origin = this.sortingIndex;\n                // This component works in reference to the original index, so there are always two possible placeholders\n                // in between the moved component. However we want to send the new index without that space\n                const destination = this.showPlaceholderForIndex - (this.showPlaceholderForIndex > this.sortingIndex ? 1 : 0);\n\n                this.sortingIndex = null;\n                m.redraw();\n\n                if (destination !== origin) {\n                    vnode.attrs.onsort(origin, destination);\n                }\n            }\n        };\n\n        document.addEventListener('drop', this.drophandler);\n    }\n\n    onremove() {\n        document.removeEventListener('dragover', this.dragoverenterhandler);\n        document.removeEventListener('dragenter', this.dragoverenterhandler);\n        document.removeEventListener('drop', this.drophandler);\n    }\n\n    view(vnode: Vnode<SortableAttrs>) {\n        const children: Vnode[] = [];\n\n        (vnode.children as Vnode<any>[]).forEach((content, index) => {\n            if (this.sortingIndex !== null && this.showPlaceholderForIndex === index) {\n                children.push(this.placeholder(vnode));\n            }\n\n            if (index === this.sortingIndex) {\n                if (!content.attrs.style) {\n                    content.attrs.style = {};\n                }\n\n                content.attrs.style.display = 'none';\n            }\n\n            content.attrs['data-index'] = index;\n            content.attrs.ondragstart = (event: DragEvent) => {\n                if (!event.target || !event.dataTransfer) {\n                    return;\n                }\n\n                let {handleClassName} = vnode.attrs;\n\n                // By default we only handle moves that have this class name\n                // The check can be disabled by setting handleClassName to null\n                if (typeof handleClassName === 'undefined') {\n                    handleClassName = 'js-handle';\n                }\n\n                if ((!handleClassName || (event.target as HTMLElement).classList.contains(handleClassName)) && !vnode.attrs.disabled) {\n                    const element = Array.from((vnode as any as VnodeDOM).dom.childNodes as any as HTMLElement[]).find(elem => elem.dataset.index === index + '');\n\n                    // This should usually not happen since all referenced indexes should exist\n                    // But this pleases typescript\n                    if (!element) {\n                        return;\n                    }\n\n                    const position = element.getBoundingClientRect();\n\n                    event.dataTransfer.effectAllowed = 'move';\n                    event.dataTransfer.setData('text/plain', index + ''); // Cast to string\n                    event.dataTransfer.setDragImage(element, event.pageX - position.left - window.scrollX, event.pageY - position.top - window.scrollY);\n\n                    this.sortingIndex = index;\n                    this.showPlaceholderForIndex = index;\n                } else {\n                    // @ts-ignore Mithril event redraw\n                    event.redraw = false;\n                }\n            };\n\n            children.push(content);\n        });\n\n        if (this.sortingIndex !== null && this.showPlaceholderForIndex === (vnode.children as Vnode[]).length) {\n            children.push(this.placeholder(vnode));\n        }\n\n        const attrs: any = {};\n\n        if (vnode.attrs.className) {\n            attrs.className = vnode.attrs.className;\n        }\n\n        return m(vnode.attrs.containerTag || 'div', attrs, children);\n    }\n\n    placeholder(vnode: Vnode<SortableAttrs>): Vnode {\n        return m(vnode.attrs.placeholderTag || 'div', {\n            className: 'SortablePlaceholder',\n            key: 'placeholder',\n        }, vnode.attrs.placeholderTag === 'tr' ? m('td', {\n            colspan: 100,\n        }) : null);\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import {ClassComponent, Vnode} from 'mithril';\nimport icon from 'flarum/common/helpers/icon';\n\nexport interface SortableHandleAttrs {\n    elementTag?: string\n    className?: string\n    disabled?: boolean\n}\n\nexport default class SortableHandle implements ClassComponent<SortableHandleAttrs> {\n    view(vnode: Vnode<SortableHandleAttrs>) {\n        const attrs: any = {\n            className: (vnode.attrs.className ? vnode.attrs.className + ' ' : '') + 'js-handle',\n        };\n\n        if (vnode.attrs.disabled) {\n            attrs.className += ' disabled';\n        } else {\n            attrs.draggable = 'true';\n        }\n\n        return m(vnode.attrs.elementTag || 'div', attrs, icon('fas fa-grip-lines'));\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/highlight'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","import app from 'flarum/common/app';\nimport User from 'flarum/common/models/User';\nimport username from 'flarum/common/helpers/username';\nimport highlight from 'flarum/common/helpers/highlight';\nimport avatar from 'flarum/common/helpers/avatar';\nimport AbstractRelationshipSelect from './AbstractRelationshipSelect';\n\nexport default class UserRelationshipSelect extends AbstractRelationshipSelect<User> {\n    protected resultsCache = new Map<string, User[]>();\n\n    className() {\n        return 'UserRelationshipSelect';\n    }\n\n    search(query: string) {\n        if (!query) {\n            m.redraw();\n            return Promise.resolve();\n        }\n\n        return app.store\n            .find<User[]>('users', {\n                filter: {q: query},\n                page: {limit: 5},\n            })\n            .then((results) => {\n                this.resultsCache.set(query, results);\n                m.redraw();\n            });\n    }\n\n    results(query: string) {\n        if (!query) {\n            return this.suggestedResults();\n        }\n\n        query = query.toLowerCase();\n\n        const results = this.resultsCache.get(query);\n\n        // Indicates still loading\n        if (typeof results === 'undefined') {\n            return null;\n        }\n\n        return (results || [])\n            .concat(\n                app.store\n                    .all<User>('users')\n                    .filter((user) => [user.username(), user.displayName()].some((value) => value.toLowerCase().substr(0, query.length) === query))\n            )\n            .filter((e, i, arr) => arr.lastIndexOf(e) === i)\n            .sort((a, b) => a.displayName().localeCompare(b.displayName()));\n    }\n\n    item(user: User, query?: string) {\n        const name = username(user);\n\n        return [\n            avatar(user),\n            query ? {\n                // Re-build a Mithril text node into a tag node with highlight\n                ...name,\n                text: undefined,\n                children: [highlight(name.text as string, query)],\n            } : name,\n        ];\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import {Vnode} from 'mithril';\nimport app from 'flarum/common/app';\nimport Page, {IPageAttrs} from 'flarum/common/components/Page';\nimport Model from 'flarum/common/Model';\n\nexport default abstract class AbstractShowPage<CustomAttrs extends IPageAttrs = IPageAttrs> extends Page<CustomAttrs> {\n    oninit(vnode: Vnode<CustomAttrs, this>) {\n        super.oninit(vnode);\n\n        this.load();\n    }\n\n    load() {\n        const preloaded = app.preloadedApiDocument();\n\n        const id = m.route.param('id');\n\n        if (id === 'new') {\n            const newRecord = this.newRecord();\n\n            if (newRecord) {\n                this.show(newRecord);\n            }\n        } else if (preloaded instanceof Model) {\n            this.show(preloaded);\n        } else {\n            const params = this.requestParams();\n\n            app.store.find(this.findType(), id, params).then(model => {\n                this.show(model);\n\n                m.redraw();\n            });\n        }\n    }\n\n    newRecord(): Model | null {\n        return null;\n    }\n\n    findType(): string {\n        return '';\n    }\n\n    requestParams(): any {\n        return {};\n    }\n\n    show(model: Model) {\n        //\n    }\n\n    /**\n     * This method allows saving a model without the values changing in the store before a successful save\n     * It's important to use createRecord and model.pushData which don't update the store\n     * @param id\n     * @param attributes\n     */\n    saveThroughNewRecord<T extends Model = Model>(id: string, attributes: any): Promise<T> {\n        const record = this.newRecord();\n\n        if (!record) {\n            return Promise.reject();\n        }\n\n        if (id) {\n            record.pushData({id});\n            record.exists = true;\n        }\n\n        return record.save(attributes);\n    }\n}\n","import app from 'flarum/common/app';\nimport Model from 'flarum/common/Model';\n\nexport class Page<T extends Model> {\n    number: number;\n    items: T[];\n    links: any;\n\n    constructor(number: number, items: T[], links: any = {}) {\n        this.number = number;\n        this.items = items;\n        this.links = links || {};\n    }\n}\n\nexport default class AbstractListState<T extends Model> {\n    params: any = {};\n    pages: Page<T>[] = [];\n    loading: boolean = true;\n    moreResults: boolean = false;\n\n    constructor(params: any = {}) {\n        this.params = params;\n    }\n\n    type(): string {\n        return '';\n    }\n\n    limit(): number {\n        return 20;\n    }\n\n    requestParams() {\n        const params: any = {filter: this.params.filter || {}};\n\n        if (this.params.sort) {\n            params.sort = this.params.sort;\n        }\n\n        if (this.params.include) {\n            params.include = this.params.include;\n        }\n\n        if (this.params.q) {\n            params.filter.q = this.params.q;\n        }\n\n        return params;\n    }\n\n    clear() {\n        this.pages = [];\n        m.redraw();\n    }\n\n    refresh({deferClear = false} = {}) {\n        this.loading = true;\n\n        if (!deferClear) {\n            this.clear();\n        }\n\n        return this.loadResults(0).then(\n            results => {\n                this.pages = [];\n                this.parseResults(results, 0);\n            },\n            () => {\n                this.loading = false;\n                m.redraw();\n            }\n        );\n    }\n\n    loadResults(offset: number) {\n        const preloaded = app.preloadedApiDocument();\n\n        if (preloaded) {\n            return Promise.resolve(preloaded);\n        }\n\n        const params = this.requestParams();\n        params.page = {offset};\n\n        return app.store.find(this.type(), params);\n    }\n\n    loadMore() {\n        this.loading = true;\n\n        const nextPageNumber = this.pages.length;\n\n        this.loadResults(nextPageNumber * this.limit())\n            .then(results => {\n                this.parseResults(results, nextPageNumber);\n            });\n    }\n\n    parseResults(results: any, number: number) {\n        if (results.length) {\n            this.pages.push(new Page(number, results, results.payload.links));\n        }\n\n        this.moreResults = results.payload.links && !!results.payload.links.next;\n\n        this.loading = false;\n\n        m.redraw();\n\n        return results;\n    }\n\n    remove(model: T) {\n        this.pages.forEach(page => {\n            const index = page.items.indexOf(model);\n\n            if (index !== -1) {\n                page.items.splice(index, 1);\n            }\n        });\n    }\n\n    add(model: T) {\n        // There should generally be a page, even if it's empty\n        // However if the list was never loaded/refreshed it might not exist\n        // We'll just push a first page if that happens\n        if (!this.pages.length) {\n            this.pages.push(new Page<T>(1, []));\n        }\n\n        this.pages[0].items.unshift(model);\n    }\n}\n","import AbstractRelationshipSelect from './components/AbstractRelationshipSelect';\nimport AbstractSortDropdown from './components/AbstractSortDropdown';\nimport ActiveLinkButton from './components/ActiveLinkButton';\nimport Sortable from './components/Sortable';\nimport SortableHandle from './components/SortableHandle';\nimport UserRelationshipSelect from './components/UserRelationshipSelect';\nimport AbstractShowPage from './pages/AbstractShowPage';\nimport * as AbstractListState from './states/AbstractListState';\nimport KeyboardNavigatable from './utils/KeyboardNavigatable';\n\nexport const common = {\n    'components/AbstractRelationshipSelect': AbstractRelationshipSelect,\n    'components/AbstractSortDropdown': AbstractSortDropdown,\n    'components/ActiveLinkButton': ActiveLinkButton,\n    'components/Sortable': Sortable,\n    'components/SortableHandle': SortableHandle,\n    'components/UserRelationshipSelect': UserRelationshipSelect,\n    'pages/AbstractShowPage': AbstractShowPage,\n    'states/AbstractListState': AbstractListState,\n    'utils/KeyboardNavigatable': KeyboardNavigatable,\n}\n","import app from 'flarum/forum/app';\nimport {extend} from 'flarum/common/extend';\nimport SessionDropdown from 'flarum/forum/components/SessionDropdown';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport {common} from '../common/compat';\nimport registerPatchInitializer from '../common/registerPatchInitializer';\n\nexport {\n    common,\n};\n\napp.initializers.add('flamarkt-backoffice', () => {\n    extend(SessionDropdown.prototype, 'items', function (items) {\n        if (app.forum.attribute('backofficeUrl')) {\n            items.add('flamarkt-backoffice', LinkButton.component({\n                icon: 'fas fa-tachometer-alt',\n                href: app.forum.attribute('backofficeUrl'),\n                target: '_blank',\n            }, app.translator.trans('flamarkt-backoffice.lib.header.backoffice_button')));\n        }\n    });\n});\n\nregisterPatchInitializer();\n","import app from 'flarum/common/app';\nimport patchModelHasOneNull from './patchModelHasOneNull';\nimport patchStoreAllowVerbatimRelationships from './patchStoreAllowVerbatimRelationships';\n\nexport default function () {\n    // On one hand these need to run as early as possible because they need to override Model.hasOne which is used in other extension's extenders\n    // But priority might need to be adjusted because it need to run as late as possible for the null catch to be the most outward override and therefore runs before other overrides\n    app.initializers.add('flamarkt-backoffice-patch', () => {\n        patchModelHasOneNull();\n        patchStoreAllowVerbatimRelationships();\n    }, 100);\n}\n","import {override} from 'flarum/common/extend';\nimport Model from 'flarum/common/Model';\n\n/**\n * Fixes inability to use null hasOne relationships with Flarum javascript models\n * @see https://github.com/flarum/core/issues/2876\n */\nexport default function () {\n    // Allow passing null relationships in Model.prototype.save()\n    override(Model, 'getIdentifier' as any, function (original: (model: Model) => any, model: Model | any) {\n        if (!model) {\n            return null;\n        }\n\n        return original(model);\n    });\n\n    // Don't error if the data property exists on the relationship but is null\n    // null is allowed as per https://jsonapi.org/format/#document-resource-object-linkage\n    override(Model, 'hasOne', function (original: (name: string) => (() => any), name: string) {\n        return function (this: Model) {\n            if (this.data.relationships) {\n                const relationship = this.data.relationships[name];\n\n                if (relationship && !relationship.data) {\n                    // Flarum might use false here. The code only looks for falsy for now anyway\n                    return null;\n                }\n            }\n\n            return original(name).call(this);\n        };\n    });\n}\n","import {override} from 'flarum/common/extend';\nimport Model from 'flarum/common/Model';\n\n/**\n * The way Flarum parses relationships inside of the save() method prevents us from saving data alongside the relation\n * To work around this, we override this method that will allow us to pass down raw objects directly in the model during save\n * The same code is used in fof/taxonomies\n */\nexport default function () {\n    override(Model, 'getIdentifier' as any, function (original: (model: Model) => any, model: Model | any) {\n        // This is fixed by patchModelHasOneNull but we need to handle it here as well depending on the load order\n        if (!model) {\n            return null;\n        }\n\n        if (model.verbatim) {\n            delete model.verbatim;\n\n            return model;\n        }\n\n        return original(model);\n    });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Keys","KeyboardNavigatable","callbacks","Map","whenCallback","event","onUp","callback","this","set","ArrowUp","e","preventDefault","onDown","ArrowDown","onSelect","ignoreTabPress","handler","Tab","Enter","onTab","onCancel","Escape","stopPropagation","onRemove","Backspace","KeyboardEvent","target","HTMLInputElement","selectionStart","selectionEnd","when","bindTo","$element","addEventListener","navigate","keyCallback","which","AbstractRelationshipSelect","searchFilter","debouncedSearchFilter","searchDebouncer","activeListIndex","inputIsFocused","navigator","dropdownIsFocused","onmousedown","cachedSuggestedResults","suggestedPromiseLoaded","className","normalizedValue","Array","isArray","attrs","relationship","setValue","models","onchange","hasOne","length","oninit","vnode","setIndex","select","toggleModel","oncreate","element","dom","dropdown","querySelector","contains","m","redraw","document","onremove","removeEventListener","indexInSelectedModels","model","findIndex","id","addModel","push","removeModel","index","splice","view","results","directionUp","reverse","classList","focused","disabled","readonly","formItems","toArray","listAvailableModels","items","ItemList","add","focus","inputItems","map","onclick","onready","item","placeholder","oninput","clearTimeout","setTimeout","search","onkeydown","onfocus","oninputfocus","onblur","oninputblur","content","LoadingIndicator","listAvailableModel","selected","active","onmouseover","getDomElement","dispatchEvent","Event","$","scrollToItem","$dropdown","indexLength","$item","scrollTop","dropdownScroll","dropdownTop","offset","top","dropdownBottom","outerHeight","itemTop","itemBottom","parseInt","css","stop","animate","first","HTMLElement","bounding","getBoundingClientRect","window","innerHeight","bottom","suggestedResults","suggest","then","Component","_extends","assign","i","arguments","source","apply","AbstractSortDropdown","initAttrs","state","console","warn","list","options","activeSort","Dropdown","buttonClassName","label","icon","sortIsUp","keys","Button","applySort","params","sort","defaultSort","substr","route","param","updateUrl","routeName","app","refresh","ActiveLinkButton","isActive","href","activeRoutes","some","currentRouteName","matchAllIndex","indexOf","LinkButton","Sortable","sortingIndex","showPlaceholderForIndex","dragoverenterhandler","drophandler","dataTransfer","dropEffect","targetIndex","childNodes","forEach","dataset","isNaN","position","direction","width","middleX","left","pageX","scrollX","height","middleY","pageY","scrollY","origin","destination","onsort","children","style","display","ondragstart","handleClassName","from","find","elem","effectAllowed","setData","setDragImage","containerTag","placeholderTag","colspan","SortableHandle","draggable","elementTag","UserRelationshipSelect","resultsCache","query","filter","q","page","limit","Promise","resolve","toLowerCase","concat","user","username","displayName","arr","lastIndexOf","b","localeCompare","name","avatar","text","undefined","highlight","AbstractShowPage","load","preloaded","newRecord","show","Model","requestParams","findType","saveThroughNewRecord","attributes","record","pushData","exists","save","reject","Page","number","links","AbstractListState","pages","loading","moreResults","type","include","clear","deferClear","loadResults","parseResults","loadMore","nextPageNumber","payload","next","remove","unshift","common","extend","SessionDropdown","override","original","data","relationships","verbatim"],"sourceRoot":""}